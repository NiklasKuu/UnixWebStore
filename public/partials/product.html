<nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <img class="navbar-brand" src="images/favicon.png"/>
      <a class="navbar-brand" href="/#/">Pete's Web Store</a>
    </div>
    <ul class="nav navbar-nav">
      <li><a href="/#/">Home</a></li>
      <li><a href="/#/products">Products</a></li>
    </ul>

    <!-- Hide if user is logged in -->
    <ul ng-hide="isLoggedIn" class="nav navbar-nav navbar-right">
      <li><a href="/#/register"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
      <li><a href="/#/login"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
    </ul>
    <!-- Show if user is logged in -->
    <ul ng-show="isLoggedIn" class="nav navbar-nav navbar-right">
      <li><a href="{{'/#/profile/' + currentUser.id}}">{{'Hello ' + currentUser.name + '!'}}</a></li>
      <li><a href="" ng-click="logout()"><span class="glyphicon glyphicon-log-out"></span> Log Out</a></li>
    </ul>
    <form class="navbar-form navbar-right">
      <div class="form-group">
        <input type="text" class="form-control" placeholder="Product" list="somethingelse" ng-change="generateRecomendation()" ng-model="productSearch">
        <datalist id="somethingelse">
          <option ng-repeat='product in productSearchRecomendation' value="{{product}}"></option>
        </datalist>
      </div>
      <button type="submit" class="btn btn-default" ng-click="submit()" >Search</button>
    </form>
  </div>
</nav>
<div class="container">
  <div class="page-header">
    <h1>{{product.name}}</h1>
  </div>

  <div class="alert alert-danger" ng-show="purchaseFail">
    {{purchaseMessage}}
  </div>
  <div class="alert alert-success" ng-show="purchaseSuccess">
    {{purchaseMessage}}
  </div>

  <div class="col-md-6 col-xs-12">
    <img class="home-product-image" src="images/Placeholder.jpg"/>
  </div>
  <div class="col-md-6 col-xs-12">
    <button ng-show="{{isLoggedIn && currentUser.accountType === 3}}" type="button" class="btn btn-primary product-purchase-button" data-toggle="modal" data-target="#purchaseModal"><span class="glyphicon glyphicon-shopping-cart"></span> Purchase</button>
    <button ng-show="{{isLoggedIn && currentUser.accountType === 2}}" type="button" class="btn btn-primary product-edit-stock" data-toggle="modal" data-target="#stockEditModal"> Edit Stock</button>
    <button ng-show="{{isLoggedIn && currentUser.accountType === 1}}" type="button" class="btn btn-primary product-edit" data-toggle="modal" data-target="#editModal"> Edit Product Details</button>

    <!-- Edit Product Modal -->
    <div id="editModal" class="modal fade" role="dialog">
      <div class="modal-dialog">
        
        <!-- Modal-content -->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Edit <strong>{{product.name}}</strong></h4>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="editName">Name:</label>
              <input type="text" class="form-control" id="editName"ng-model="product.name">
            </div>
            <div class="form-group">
              <label for="editPrice">Price:</label>
              <input type="number" class="form-control" id="editPrice"  ng-model="product.price">
            </div>
            <div class="form-group">
              <label for="editStock">Stock:</label>
              <input type="number" class="form-control" id="editStock" ng-model="product.stock">
            </div>
            <div class="form-group">
              <label for="editBought">Bought:</label>
              <input type="number" class="form-control" id="editBought" ng-model="product.bought">
            </div>
            <div class="form-group">
              <label for="editDescription">Description:</label>
              <textarea class="form-control" rows="5" id="editDescription" ng-model="product.description"></textarea>
            </div> 
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="editProduct()">Save</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="renderProduct()">Cancel</button>
          </div>  
        </div>
      </div>
    </div>

    <!-- Edit Stock Modal -->
    <div id="stockEditModal" class="modal fade" role="dialog">
      <div class="modal-dialog">

        <!-- Modal-content -->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Edit <strong>{{product.name}}</strong> Stock</h4>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="newStock">stock</label>
              <input type="number" class="form-control" id="newStock" value={{product.stock}} ng-model="newStock">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="changeStock()">Save</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          </div>  
        </div>
      </div>
    </div>

    <!-- Purchase Units Modal -->
    <div id="purchaseModal" class="modal fade" role="dialog">
      <div class="modal-dialog">
        
        <!-- Modal-content -->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Purchase <strong>{{product.name}}</strong></h4>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="amount">Amount:           total price: {{amount * product.price}}€</label>
              <input type="number" class="form-control" id="amount" ng-model="amount">
            </div>
            <div class="form-group">
              <label for="money">Payment: €</label>
              <input type="number" class="form-control" id="money" ng-model="payment">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="purchase()">Purchase</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel Purchase</button>
          </div>  
        </div>
      </div>
    </div>

    <p><b>price: {{product.price}}€</b></p>
    <p><b>stock: {{product.stock}} {{product.stock == 1 ? "unit" : "units"}}</b></p>
    <p ng-show="{{currentUser.accountType < 3}}"><b>bought: {{product.bought}} {{product.bought == 1 ? "unit" : "units"}}</b></p>
    <h3>Description</h3>
    <p>{{product.description}}</p>
  </div>
</div>
